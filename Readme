https://docs.google.com/presentation/d/1Q6FoEg8pIisy4UA3wAnQ4KXtxMA6bNqU05hHObKBXE8/edit?usp=sharing

================================================================
Step1 : GEN-SIM

cmsDriver.py Configuration/GenProduction/python/WprimeToENu_M_1000_TuneCP5_14TeV_pythia8_cfi.py --fileout file:step1_wptoenu_1000_GS.root --mc --eventcontent RAWSIM --datatier GEN-SIM --conditions 110X_mcRun3_2021_realistic_v6 --beamspot Run3RoundOptics25ns13TeVLowSigmaZ --step GEN,SIM --nThreads 8 --geometry DB:Extended --era Run3 --python_filename step1_wptoenu_1000_GS_cfg.py --no_exec --customise Configuration/DataProcessing/Utils.addMonitoring -n 2000

cmsRun step1_wptoenu_1000_GS_cfg.py >& cmdLog_step1_wptoenu_1000_GS.log &

================================================================
Step2 : Digi-Reco with Data PreMix PU --> DR with noPU

# OLD Step 2 ## Run3Winter20DRPremixMiniAOD
#cmsDriver.py step1 --fileout file:WprimeToENu_M_1000_premix.root --pileup_input "dbs:/Neutrino_E-10_gun/RunIISummer17PrePremix-PURun3Winter20_110X_mcRun3_2021_realistic_v6-v2/PREMIX" --mc --eventcontent PREMIXRAW --datatier GEN-SIM-RAW --conditions 110X_mcRun3_2021_realistic_v6 --step DIGI,DATAMIX,L1,DIGI2RAW,HLT:GRun --procModifiers premix_stage2 --nThreads 8 --geometry DB:Extended --datamix PreMix --era Run3 --filein file:WprimeToENu_M_1000_gensim.root --python_filename WprimeToENu_M-1000_premix_cfg.py --no_exec --customise Configuration/DataProcessing/Utils.addMonitoring -n 2000
## user    139m11.207s

	NB : We will not consider PU to save time for generation. 
	So please use cmsDriver.py as follow:

cmsDriver.py step1 --fileout file:step2_wptoenu_1000_DRnoPU.root --pileup NoPileUp --mc --eventcontent RAWSIM --datatier GEN-SIM-RAW --conditions 110X_mcRun3_2021_realistic_v6 --step DIGI,L1,DIGI2RAW,HLT:GRun --nThreads 8 --geometry DB:Extended --era Run3 --filein file:step1_wptoenu_1000_GS.root --python_filename step2_wptoenu_1000_DRnoPU_cfg.py --no_exec --customise Configuration/DataProcessing/Utils.addMonitoring -n 2000

cmsRun step2_wptoenu_1000_DRnoPU_cfg.py >& cmdLog_step2_wptoenu_1000_DRnoPU.log &

================================================================
Step3 : AODSIM, MINIAODSIM 

# OLD Step 2-1 ## Run3Winter20DRPremixMiniAOD
#cmsDriver.py step2 --filein file:WprimeToENu_M_1000_premix.root --fileout file:WprimeToENu_M_1000_miniaod.root --mc --eventcontent AODSIM,MINIAODSIM --runUnscheduled --datatier AODSIM,MINIAODSIM --conditions 110X_mcRun3_2021_realistic_v6 --step RAW2DIGI,L1Reco,RECO,RECOSIM,EI,PAT --procModifiers premix_stage2 --nThreads 8 --geometry DB:Extended --era Run3 --python_filename WprimeToENu_M-1000_miniaod_cfg.py --no_exec --customise Configuration/DataProcessing/Utils.addMonitoring -n 2000

	NB : We will not consider PU to save time for generation. 
	So please use cmsDriver.py as follow:

cmsDriver.py step2 --filein file:step2_wptoenu_1000_DRnoPU.root --fileout file:step3_wptoenu_1000_mini.root --mc --eventcontent AODSIM,MINIAODSIM --runUnscheduled --datatier AODSIM,MINIAODSIM --conditions 110X_mcRun3_2021_realistic_v6 --step RAW2DIGI,L1Reco,RECO,RECOSIM,EI,PAT --nThreads 8 --geometry DB:Extended --era Run3 --python_filename step3_wptoenu_1000_MINI_cfg.py --no_exec --customise Configuration/DataProcessing/Utils.addMonitoring -n 2000

time `cmsRun step3_wptoenu_1000_MINI_cfg.py >& cmdLog_step3_wptoenu_1000_MINI.log `

================================================================
Step4 : NANOAODSIM

cmsDriver.py step1 --filein file:step3_wptoenu_1000_mini.root --fileout file:wptoenu_1000_nano.root --mc --eventcontent NANOAODSIM --runUnscheduled --datatier NANOAODSIM --conditions 110X_mcRun3_2021_realistic_v6 --step NANO --nThreads 8  --era Run3 --python_filename step4_wptoenu_1000_NANO_cfg.py --no_exec --customise Configuration/DataProcessing/Utils.addMonitoring  --customise_commands="process.add_(cms.Service('InitRootHandlers', EnableIMT = cms.untracked.bool(False)))"  -n 2000

================================================================



#### Step 1 ## Run3Winter20GS = GEN-SIM (PYTHIA8)
##cmsDriver.py Configuration/GenProduction/python/WprimeToENu_M_1000_TuneCP5_14TeV_pythia8_cfi.py --fileout file:WprimeToENu_M_1000_gensim.root --mc --eventcontent RAWSIM --datatier GEN-SIM --conditions 110X_mcRun3_2021_realistic_v6  --beamspot Run3RoundOptics25ns13TeVLowSigmaZ  --step GEN,SIM --nThreads 8 --geometry DB:Extended --era Run3 --python_filename WprimeToENu_M-1000_gensim_cfg.py --no_exec --customise Configuration/DataProcessing/Utils.addMonitoring  -n 2000
##
#### Step 2 ## Run3Winter20DRPremixMiniAOD
##cmsDriver.py step1 --fileout file:WprimeToENu_M_1000_premix.root --pileup_input "dbs:/Neutrino_E-10_gun/RunIISummer17PrePremix-PURun3Winter20_110X_mcRun3_2021_realistic_v6-v2/PREMIX" --mc --eventcontent PREMIXRAW --datatier GEN-SIM-RAW --conditions 110X_mcRun3_2021_realistic_v6 --step DIGI,DATAMIX,L1,DIGI2RAW,HLT:GRun --procModifiers premix_stage2 --nThreads 8 --geometry DB:Extended --datamix PreMix --era Run3 --filein file:WprimeToENu_M_1000_gensim.root --python_filename WprimeToENu_M-1000_premix_cfg.py --no_exec --customise Configuration/DataProcessing/Utils.addMonitoring -n 2000
##
##
#### Step 2-1 ## Run3Winter20DRPremixMiniAOD
##cmsDriver.py step2 --filein file:WprimeToENu_M_1000_premix.root --fileout file:WprimeToENu_M_1000_miniaod.root --mc --eventcontent AODSIM,MINIAODSIM --runUnscheduled --datatier AODSIM,MINIAODSIM --conditions 110X_mcRun3_2021_realistic_v6 --step RAW2DIGI,L1Reco,RECO,RECOSIM,EI,PAT --procModifiers premix_stage2 --nThreads 8 --geometry DB:Extended --era Run3 --python_filename WprimeToENu_M-1000_miniaod_cfg.py --no_exec --customise Configuration/DataProcessing/Utils.addMonitoring -n 2000
##
##=================================================
## Step 1 ## Run3Winter20GS = GEN-SIM (PYTHIA8)
#cmsDriver.py Configuration/GenProduction/python/WprimeToENu_M_1000_TuneCP5_14TeV_pythia8_cfi.py --fileout file:WprimeToENu_M_1000_gensim.root --mc --eventcontent RAWSIM --datatier GEN-SIM --conditions 110X_mcRun3_2021_realistic_v6  --beamspot Run3RoundOptics25ns13TeVLowSigmaZ  --step GEN,SIM --nThreads 8 --geometry DB:Extended --era Run3 --python_filename WprimeToMuNu_M-1000_gensim_cfg.py --no_exec --customise Configuration/DataProcessing/Utils.addMonitoring  -n 2000

## Run3Winter20wmLHEGS = GEN-SIM, LHE (MADGRAPH)
#cmsDriver.py Configuration/GenProduction/python/TSG-Run3Winter20wmLHEGS-00006-fragment.py --fileout file:TSG-Run3Winter20wmLHEGS-00006.root --mc --eventcontent RAWSIM,LHE --datatier GEN-SIM,LHE --conditions 110X_mcRun3_2021_realistic_v6 --beamspot Run3RoundOptics25ns13TeVLowSigmaZ --step LHE,GEN,SIM --nThreads 8 --geometry DB:Extended --era Run3 --python_filename TSG-Run3Winter20wmLHEGS-00006_1_cfg.py --no_exec --customise Configuration/DataProcessing/Utils.addMonitoring --customise_commands process.RandomNumberGeneratorService.externalLHEProducer.initialSeed="int(${seed})" -n 1656

## OLD Run3Summer20GS (WToMuNu)
#cmsDriver.py Configuration/GenProduction/python/EXO-Run3Summer19GS-00001-fragment.py --fileout file:EXO-Run3Summer19GS-00001.root --mc --eventcontent RAWSIM --datatier GEN-SIM --conditions 106X_upgrade2021_realistic_v5 --beamspot Run3RoundOptics25ns13TeVLowSigmaZ --step GEN,SIM --nThreads 8 --geometry DB:Extended --era Run3 --python_filename EXO-Run3Summer19GS-00001_1_cfg.py --no_exec --customise Configuration/DataProcessing/Utils.addMonitoring -n 1767 || exit $? ; 

=================================================
### Step 2 ## Run3Winter20DRPremixMiniAOD
#cmsDriver.py step1 --fileout file:TSG-Run3Winter20DRPremixMiniAOD-00076_step1.root  \\
#--pileup_input "dbs:/Neutrino_E-10_gun/RunIISummer17PrePremix-PURun3Winter20_110X_mcRun3_2021_realistic_v6-v2/PREMIX" \\
#--mc --eventcontent PREMIXRAW \\
#--datatier GEN-SIM-RAW --conditions 110X_mcRun3_2021_realistic_v6 \\
#--step DIGI,DATAMIX,L1,DIGI2RAW,HLT:GRun \\
#--procModifiers premix_stage2 --nThreads 8 --geometry DB:Extended --datamix PreMix \\
#--era Run3 --python_filename TSG-Run3Winter20DRPremixMiniAOD-00076_1_cfg.py --no_exec \\
#--customise Configuration/DataProcessing/Utils.addMonitoring -n 740 || exit $? ;
#
### Run3Winter20DRMiniAOD (Flat55To75)
#cmsDriver.py step1 --fileout file:TRK-Run3Winter20DRMiniAOD-00032_step1.root \\
#--pileup_input "dbs:/MinBias_TuneCP5_14TeV-pythia8/Run3Winter20GS-110X_mcRun3_2021_realistic_v6-v1/GEN-SIM" \\
#--mc --eventcontent RAWSIM \\
#--pileup Run3_Flat55To75_PoissonOOTPU \\
#--datatier GEN-SIM-RAW --conditions 110X_mcRun3_2021_realistic_v6 \\
#--step DIGI,L1,DIGI2RAW,HLT:GRun --nThreads 8 --geometry DB:Extended --era Run3 \\
#--python_filename TRK-Run3Winter20DRMiniAOD-00032_1_cfg.py --no_exec \\
#--customise Configuration/DataProcessing/Utils.addMonitoring -n 214 || exit $? ; 
#
### Run3Winter20DRMiniAOD (FlatPU0to80)
#cmsDriver.py step1 --fileout file:TSG-Run3Winter20DRMiniAOD-00013_step1.root \\
#--pileup_input "dbs:/MinBias_TuneCP5_14TeV-pythia8/Run3Winter20GS-110X_mcRun3_2021_realistic_v6-v1/GEN-SIM" \\
#--mc --eventcontent RAWSIM \\
#--pileup Flat_10_50_25ns \\
#--datatier GEN-SIM-RAW --conditions 110X_mcRun3_2021_realistic_v6 \\
#--customise_commands "process.mix.input.nbPileupEvents.probFunctionVariable = cms.vint32(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80) \n process.mix.input.nbPileupEvents.probValue = cms.vdouble(0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679,0.012345679)" \\
#--step DIGI,L1,DIGI2RAW,HLT:GRun --nThreads 8 --geometry DB:Extended --era Run3 \\
#--python_filename TSG-Run3Winter20DRMiniAOD-00013_1_cfg.py --no_exec \\
#--customise Configuration/DataProcessing/Utils.addMonitoring -n 131 || exit $? ; 
#
### OLD Run3Summer19DRPremix (WToMuNu)
#cmsDriver.py step1 --fileout file:EXO-Run3Summer19DRPremix-00001_step1.root  \\
#--pileup_input "dbs:/Neutrino_E-10_gun/RunIISummer17PrePremix-PURun3_106X_mcRun3_2021_realistic_v3-v4/PREMIX" \\
#--mc --eventcontent PREMIXRAW \\
#--datatier GEN-SIM-RAW --conditions 106X_mcRun3_2021_realistic_v3 \\
#--customise_commands 'process.mix.digitizers.pixel.ThresholdInElectrons_BPix_L1 = cms.double(1300.0);process.mix.digitizers.pixel.ThresholdInElectrons_BPix_L2 = cms.double(1600.0);process.mix.digitizers.pixel.ThresholdInElectrons_BPix = cms.double(1600.0);process.mix.digitizers.pixel.ThresholdInElectrons_FPix = cms.double(1600);process.hltESPPixelCPEGeneric.IrradiationBiasCorrection = True' \\
#--step DIGI,DATAMIX,L1,DIGI2RAW,HLT:@relval2018 \\
#--procModifiers premix_stage2 --nThreads 8 --geometry DB:Extended \\
#--datamix PreMix --era Run3 \\
#--python_filename EXO-Run3Summer19DRPremix-00001_1_cfg.py --no_exec \\
#--customise Configuration/DataProcessing/Utils.addMonitoring -n 1202 || exit $? ; 
================================================================

